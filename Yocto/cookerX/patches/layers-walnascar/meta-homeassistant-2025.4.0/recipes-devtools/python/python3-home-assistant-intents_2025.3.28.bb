DESCRIPTION = "Intent parsing for Home Assistant"
HOMEPAGE = "https://github.com/home-assistant/intents"
LICENSE = "CC-BY-4.0"
LIC_FILES_CHKSUM = "file://LICENSE.md;md5=2ab724713fdaf49e4523c4503bfd068d"
RECIPE_MAINTAINER = "Tom Geelen <t.f.g.geelen@gmail.com>"

inherit pypi python_setuptools_build_meta ptest-python-pytest

SRC_URI[sha256sum] = "3b93717525ae738f9163a2215bb0628321b86bd8418bfd64e1d5ce571b84fef4"

PYPI_PACKAGE = "home_assistant_intents"
UPSTREAM_CHECK_PYPI_PACKAGE = "${PYPI_PACKAGE}"

RDEPENDS:${PN} = "\
    python3-core (>=3.9.0) \
"
do_configure:prepend() {
    FILE_PYPROJECT="${S}/pyproject.toml"
    #bbplain "==>>(WORKDIR: ${WORKDIR})"
    #bbplain "==>>(S: ${S})"
    bbplain "==>>(FILE_PYPROJECT: ${FILE_PYPROJECT})"

    if grep -q "^license *= *" "$FILE_PYPROJECT"; then
        sed -i 's/^license *= *.*/license = { file = "LICENSE" }/' "$FILE_PYPROJECT"
    fi
}
